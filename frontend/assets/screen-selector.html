
            <!DOCTYPE html>
            <html>
            <head>
                <meta charset="UTF-8">
                <title>Select Area</title>
                <style>
                    body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; }
                    #selection-box {
                        position: absolute;
                        border: 2px dashed #007bff;
                        background-color: rgba(0, 123, 255, 0.1);
                        box-sizing: border-box;
                    }
                    #overlay {
                        position: absolute;
                        top:0; left:0; width:100%; height:100%;
                        background-color: rgba(0,0,0,0.3);
                        cursor: crosshair;
                    }
                </style>
            </head>
            <body>
                <div id="overlay"></div>
                <div id="selection-box"></div>
                <script>
                    const { ipcRenderer } = require('electron');
                    const overlay = document.getElementById('overlay');
                    const selectionBox = document.getElementById('selection-box');
                    let startX, startY, isDrawing = false;

                    overlay.addEventListener('mousedown', (e) => {
                        startX = e.clientX;
                        startY = e.clientY;
                        isDrawing = true;
                        selectionBox.style.left = startX + 'px';
                        selectionBox.style.top = startY + 'px';
                        selectionBox.style.width = '0px';
                        selectionBox.style.height = '0px';
                        selectionBox.style.display = 'block';
                    });

                    overlay.addEventListener('mousemove', (e) => {
                        if (!isDrawing) return;
                        const width = e.clientX - startX;
                        const height = e.clientY - startY;
                        selectionBox.style.width = Math.abs(width) + 'px';
                        selectionBox.style.height = Math.abs(height) + 'px';
                        selectionBox.style.left = (width > 0 ? startX : e.clientX) + 'px';
                        selectionBox.style.top = (height > 0 ? startY : e.clientY) + 'px';
                    });

                    overlay.addEventListener('mouseup', (e) => {
                        if (!isDrawing) return;
                        isDrawing = false;
                        selectionBox.style.display = 'none';
                        const rect = {
                            x: parseInt(selectionBox.style.left),
                            y: parseInt(selectionBox.style.top),
                            width: parseInt(selectionBox.style.width),
                            height: parseInt(selectionBox.style.height)
                        };
                        ipcRenderer.send('capture-area-selected', rect);
                    });
                </script>
            </body>
            </html>
          